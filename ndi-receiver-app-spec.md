# Android NDI HX3 ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªé–‹ç™ºä»•æ§˜æ›¸

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ãƒ©ã‚¤ãƒ–ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆä¼šå ´ï¼ˆã‚­ãƒ£ãƒãƒ¬ãƒ¼ï¼‰å‘ã‘ã®æ¥­å‹™ç”¨NDI HX3æ˜ åƒå—ä¿¡ãƒ»éŒ²ç”»ãƒ»å†ç”Ÿã‚¢ãƒ—ãƒªã‚’Androidå‘ã‘ã«é–‹ç™ºã™ã‚‹ã€‚

### èƒŒæ™¯
- ä¼šå ´ã«è¨­ç½®ã•ã‚ŒãŸè¤‡æ•°ã®å¤§å‹ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼ˆ24.5ã‚¤ãƒ³ãƒï¼‰ã§NDIã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
- æ—¢å­˜ã®å•†ç”¨ã‚¢ãƒ—ãƒªã«ã¯éŒ²ç”»æ©Ÿèƒ½ãŒãªãã€å“è³ªã‚‚ä½ã„ãŸã‚è‡ªä½œãŒå¿…è¦
- è¤‡æ•°ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãŒåŒæ™‚ã«åŒã˜ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ä¿¡ã™ã‚‹é‹ç”¨

---

## ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢

### å—ä¿¡ãƒ‡ãƒã‚¤ã‚¹: FPD CP25-J1 ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ
| é …ç›® | ã‚¹ãƒšãƒƒã‚¯ |
|------|----------|
| ç”»é¢ã‚µã‚¤ã‚º | 24.5ã‚¤ãƒ³ãƒ |
| è§£åƒåº¦ | 1920Ã—1080 (FHD) |
| OS | Android 14 |
| ãƒãƒƒãƒ—ã‚»ãƒƒãƒˆ | Rockchip RK3576 |
| CPU | Cortex-A72 x4 @2.2GHz + Cortex-A53 x4 @1.8GHz |
| GPU | Mali G52 MC3 |
| RAM | 8GB |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | å†…è”µ + microSDå¯¾å¿œ |
| ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ | WiFi 6ï¼ˆæœ‰ç·šLANéæ­è¼‰ï¼‰ |
| ãƒ“ãƒ‡ã‚ªãƒ‡ã‚³ãƒ¼ãƒ‰ | H.265 4K@120fps, H.264 4K@60fpsï¼ˆãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ï¼‰ |

### æ˜ åƒã‚½ãƒ¼ã‚¹: FoMaKo K20UH PTZã‚«ãƒ¡ãƒ©
| é …ç›® | ã‚¹ãƒšãƒƒã‚¯ |
|------|----------|
| NDIè¦æ ¼ | NDI 6 / HX3 èªè¨¼å–å¾— |
| æœ€å¤§å‡ºåŠ› | **1080p@30fps**ï¼ˆEthernetãŒ100Mbpsã®ãŸã‚ï¼‰ |
| ã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ | H.264 / H.265 |
| ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆ | 20ã€œ40 Mbpsï¼ˆå¯å¤‰ï¼‰ |
| é…å»¶ | 100msä»¥ä¸‹ |

---

## æ©Ÿèƒ½è¦ä»¶

### 1. NDIã‚½ãƒ¼ã‚¹æ¤œå‡ºãƒ»æ¥ç¶š
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®NDIã‚½ãƒ¼ã‚¹ã‚’è‡ªå‹•æ¤œå‡ºï¼ˆmDNS/Bonjourï¼‰
- [ ] NDI Discovery Serverå¯¾å¿œï¼ˆç•°ãªã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã®ã‚½ãƒ¼ã‚¹ã‚‚æ¤œå‡ºå¯èƒ½ï¼‰
- [ ] ã‚½ãƒ¼ã‚¹ä¸€è¦§ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤º
- [ ] ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ã§æ¥ç¶š/åˆ‡æ–­
- [ ] æ¥ç¶šçŠ¶æ…‹ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼è¡¨ç¤º

### 2. æ˜ åƒè¡¨ç¤º
- [ ] ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼ˆ24.5ã‚¤ãƒ³ãƒç”»é¢ã«æœ€é©åŒ–ï¼‰
- [ ] ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ç¶­æŒï¼ˆãƒ¬ã‚¿ãƒ¼ãƒœãƒƒã‚¯ã‚¹/ãƒ”ãƒ©ãƒ¼ãƒœãƒƒã‚¯ã‚¹å¯¾å¿œï¼‰
- [ ] ä½é…å»¶å†ç”Ÿï¼ˆ100msä»¥ä¸‹ç›®æ¨™ï¼‰
- [ ] ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆãƒ»è§£åƒåº¦ãƒ»ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆã®OSDè¡¨ç¤ºï¼ˆãƒˆã‚°ãƒ«å¯èƒ½ï¼‰
- [ ] ç”»é¢ã‚¿ãƒƒãƒ—ã§UIè¡¨ç¤º/éè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ

### 3. éŒ²ç”»æ©Ÿèƒ½
- [ ] ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’MP4ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦éŒ²ç”»
- [ ] **H.264/H.265ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼éŒ²ç”»**ï¼ˆå†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãªã—ã€CPUè² è·ã‚¼ãƒ­ï¼‰
- [ ] éŒ²ç”»é–‹å§‹/åœæ­¢ãƒœã‚¿ãƒ³
- [ ] éŒ²ç”»ä¸­ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆRECãƒãƒ¼ã‚¯ + çµŒéæ™‚é–“ï¼‰
- [ ] éŒ²ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¯å†…éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¾ãŸã¯microSDã«ä¿å­˜
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«åè‡ªå‹•ç”Ÿæˆï¼ˆæ—¥æ™‚ãƒ™ãƒ¼ã‚¹ï¼‰

### 4. å†ç”Ÿæ©Ÿèƒ½
- [ ] éŒ²ç”»ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§è¡¨ç¤ºï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãï¼‰
- [ ] éŒ²ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç”Ÿ
- [ ] ã‚·ãƒ¼ã‚¯ãƒãƒ¼å¯¾å¿œ
- [ ] å†ç”Ÿ/ä¸€æ™‚åœæ­¢/åœæ­¢
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤æ©Ÿèƒ½

### 5. è¨­å®š
- [ ] ä¿å­˜å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é¸æŠ
- [ ] è‡ªå‹•æ¥ç¶šï¼ˆå‰å›æ¥ç¶šã—ãŸã‚½ãƒ¼ã‚¹ã«è‡ªå‹•å†æ¥ç¶šï¼‰
- [ ] ç”»é¢å¸¸æ™‚ã‚ªãƒ³è¨­å®š
- [ ] OSDè¡¨ç¤ºè¨­å®š

---

## æŠ€è¡“ä»•æ§˜

### é–‹ç™ºè¨€èªãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **è¨€èª**: Kotlin
- **æœ€å°SDK**: API 26 (Android 8.0)
- **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆSDK**: API 34 (Android 14)
- **ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ **: Gradle (Kotlin DSL)
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: MVVM + Repository ãƒ‘ã‚¿ãƒ¼ãƒ³

### ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

#### NDIå—ä¿¡: Devolay
```kotlin
// build.gradle.kts
dependencies {
    implementation("me.walkerknapp:devolay:2.1.1") {
        artifact {
            name = "devolay"
            type = "aar"
        }
    }
}
```

**Devolayã«ã¤ã„ã¦:**
- NDI SDKã®Java/Kotlinãƒ©ãƒƒãƒ‘ãƒ¼
- AARã«ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆarm64-v8a, armeabi-v7a, x86, x86_64ï¼‰ã‚’åŒæ¢±
- Maven Centralã‹ã‚‰é…å¸ƒ
- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹: LGPL-3.0ï¼ˆå•†ç”¨åˆ©ç”¨å¯ï¼‰

**å‚è€ƒãƒªãƒã‚¸ãƒˆãƒª:**
- https://github.com/WalkerKnapp/devolay
- https://github.com/daubli/NdiMonitor ï¼ˆå‹•ä½œç¢ºèªæ¸ˆã¿ã®Androidå®Ÿè£…ä¾‹ï¼‰

#### ãã®ä»–ã®ä¾å­˜é–¢ä¿‚
```kotlin
dependencies {
    // Coroutines
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3")
    
    // Lifecycle
    implementation("androidx.lifecycle:lifecycle-viewmodel-ktx:2.7.0")
    implementation("androidx.lifecycle:lifecycle-runtime-ktx:2.7.0")
    
    // RecyclerViewï¼ˆã‚½ãƒ¼ã‚¹ä¸€è¦§ãƒ»éŒ²ç”»ä¸€è¦§ç”¨ï¼‰
    implementation("androidx.recyclerview:recyclerview:1.3.2")
    
    // Glideï¼ˆã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºç”¨ï¼‰
    implementation("com.github.bumptech.glide:glide:4.16.0")
}
```

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
```
[NDI Source (K20UH)]
        â”‚
        â”‚ Network (WiFi)
        â–¼
[NsdManager] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
        â”‚ Discovery           â”‚ Discovery Server
        â–¼                     â–¼
[Devolay NDI Finder] â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ NDI HX3 Stream (H.264/H.265 compressed)
        â–¼
[Devolay NDI Receiver]
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                  â”‚
        â–¼                                  â–¼
[MediaCodec]                        [MediaMuxer]
(Hardware Decode)                   (MP4 Recording)
        â”‚                                  â”‚
        â–¼                                  â–¼
[SurfaceView]                       [Storage]
(Display)                           (Internal/SD)
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ
```
com.example.ndireceiver/
â”œâ”€â”€ MainActivity.kt
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ MainFragment.kt
â”‚   â”‚   â””â”€â”€ MainViewModel.kt
â”‚   â”œâ”€â”€ player/
â”‚   â”‚   â”œâ”€â”€ PlayerFragment.kt
â”‚   â”‚   â””â”€â”€ PlayerViewModel.kt
â”‚   â””â”€â”€ recordings/
â”‚       â”œâ”€â”€ RecordingsFragment.kt
â”‚       â””â”€â”€ RecordingsViewModel.kt
â”œâ”€â”€ ndi/
â”‚   â”œâ”€â”€ NdiManager.kt           # NDIåˆæœŸåŒ–ãƒ»çµ‚äº†
â”‚   â”œâ”€â”€ NdiFinder.kt            # ã‚½ãƒ¼ã‚¹æ¤œå‡º
â”‚   â”œâ”€â”€ NdiReceiver.kt          # ã‚¹ãƒˆãƒªãƒ¼ãƒ å—ä¿¡
â”‚   â””â”€â”€ NdiSource.kt            # ã‚½ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
â”œâ”€â”€ media/
â”‚   â”œâ”€â”€ VideoDecoder.kt         # MediaCodecãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ VideoRecorder.kt        # MediaMuxerãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ VideoPlayer.kt          # éŒ²ç”»å†ç”Ÿç”¨
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ RecordingRepository.kt
â”‚   â””â”€â”€ SettingsRepository.kt
â””â”€â”€ util/
    â”œâ”€â”€ FileUtils.kt
    â””â”€â”€ TimeUtils.kt
```

---

## å®Ÿè£…è©³ç´°

### 1. NDIåˆæœŸåŒ–ï¼ˆNdiManager.ktï¼‰

```kotlin
import me.walkerknapp.devolay.Devolay

object NdiManager {
    private var isInitialized = false
    
    fun initialize(): Boolean {
        if (isInitialized) return true
        
        // Devolay/NDI SDKã®åˆæœŸåŒ–
        isInitialized = Devolay.loadLibraries()
        return isInitialized
    }
    
    fun destroy() {
        // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†
        isInitialized = false
    }
}
```

### 2. NDIã‚½ãƒ¼ã‚¹æ¤œå‡ºï¼ˆNdiFinder.ktï¼‰

```kotlin
import me.walkerknapp.devolay.DevolayFinder
import me.walkerknapp.devolay.DevolaySource
import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.flow

class NdiFinder {
    private var finder: DevolayFinder? = null
    
    fun startDiscovery(): Flow<List<NdiSource>> = flow {
        finder = DevolayFinder()
        
        while (true) {
            // ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´ã‚’å¾…æ©Ÿï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 1000msï¼‰
            if (finder?.waitForSources(1000) == true) {
                val sources = finder?.currentSources?.map { source ->
                    NdiSource(
                        name = source.sourceName,
                        url = source.urlAddress
                    )
                } ?: emptyList()
                emit(sources)
            }
        }
    }
    
    fun stopDiscovery() {
        finder?.close()
        finder = null
    }
}

data class NdiSource(
    val name: String,
    val url: String
)
```

### 3. NDIå—ä¿¡ãƒ»ãƒ‡ã‚³ãƒ¼ãƒ‰ï¼ˆNdiReceiver.ktï¼‰

```kotlin
import me.walkerknapp.devolay.DevolayReceiver
import me.walkerknapp.devolay.DevolayVideoFrame
import android.media.MediaCodec
import android.media.MediaFormat
import android.view.Surface

class NdiReceiver(
    private val surface: Surface,
    private val onFrameReceived: ((DevolayVideoFrame) -> Unit)? = null
) {
    private var receiver: DevolayReceiver? = null
    private var decoder: MediaCodec? = null
    private var isReceiving = false
    
    fun connect(source: NdiSource) {
        // ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ä½œæˆ
        receiver = DevolayReceiver.Builder()
            .sourceName(source.name)
            .colorFormat(DevolayReceiver.ColorFormat.UYVY) // ã¾ãŸã¯ BGRA
            .build()
        
        startReceiving()
    }
    
    private fun startReceiving() {
        isReceiving = true
        
        // å—ä¿¡ãƒ«ãƒ¼ãƒ—ï¼ˆåˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œï¼‰
        Thread {
            while (isReceiving) {
                val videoFrame = DevolayVideoFrame()
                
                // ãƒ•ãƒ¬ãƒ¼ãƒ å—ä¿¡ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 5000msï¼‰
                val frameType = receiver?.receiveCapture(videoFrame, null, null, 5000)
                
                when (frameType) {
                    DevolayReceiver.FrameType.VIDEO -> {
                        processVideoFrame(videoFrame)
                        onFrameReceived?.invoke(videoFrame)
                    }
                    DevolayReceiver.FrameType.NONE -> {
                        // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¾ãŸã¯åˆ‡æ–­
                    }
                    else -> {}
                }
                
                // ãƒ•ãƒ¬ãƒ¼ãƒ ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
                receiver?.freeReceiveCapture(videoFrame, null, null)
            }
        }.start()
    }
    
    private fun processVideoFrame(frame: DevolayVideoFrame) {
        // MediaCodecã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦Surfaceã«æç”»
        // å®Ÿè£…è©³ç´°ã¯ VideoDecoder.kt ã«å§”è­²
    }
    
    fun disconnect() {
        isReceiving = false
        receiver?.close()
        receiver = null
    }
}
```

### 4. éŒ²ç”»ï¼ˆVideoRecorder.ktï¼‰

**é‡è¦: ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼éŒ²ç”»ã®å®Ÿè£…**

NDI HX3ã¯H.264/H.265ã§åœ§ç¸®æ¸ˆã¿ã®ãŸã‚ã€**å†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã›ãšã«ãã®ã¾ã¾MP4ã‚³ãƒ³ãƒ†ãƒŠã«æ ¼ç´**ã™ã‚‹ã“ã¨ã§CPUè² è·ã‚’ã‚¼ãƒ­ã«ã§ãã‚‹ã€‚

```kotlin
import android.media.MediaMuxer
import android.media.MediaFormat
import java.io.File
import java.text.SimpleDateFormat
import java.util.*

class VideoRecorder(
    private val outputDir: File
) {
    private var muxer: MediaMuxer? = null
    private var videoTrackIndex: Int = -1
    private var isRecording = false
    private var startTime: Long = 0
    
    fun startRecording(videoFormat: MediaFormat): File {
        val timestamp = SimpleDateFormat("yyyyMMdd_HHmmss", Locale.getDefault())
            .format(Date())
        val outputFile = File(outputDir, "NDI_$timestamp.mp4")
        
        muxer = MediaMuxer(
            outputFile.absolutePath,
            MediaMuxer.OutputFormat.MUXER_OUTPUT_MPEG_4
        )
        
        // ãƒ“ãƒ‡ã‚ªãƒˆãƒ©ãƒƒã‚¯è¿½åŠ ï¼ˆå…ƒã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ãã®ã¾ã¾ä½¿ç”¨ï¼‰
        videoTrackIndex = muxer!!.addTrack(videoFormat)
        muxer!!.start()
        
        isRecording = true
        startTime = System.nanoTime()
        
        return outputFile
    }
    
    fun writeVideoFrame(data: ByteArray, presentationTimeUs: Long) {
        if (!isRecording || muxer == null) return
        
        val buffer = java.nio.ByteBuffer.wrap(data)
        val bufferInfo = android.media.MediaCodec.BufferInfo().apply {
            offset = 0
            size = data.size
            this.presentationTimeUs = presentationTimeUs
            flags = 0
        }
        
        muxer?.writeSampleData(videoTrackIndex, buffer, bufferInfo)
    }
    
    fun stopRecording() {
        isRecording = false
        muxer?.stop()
        muxer?.release()
        muxer = null
    }
    
    fun isRecording() = isRecording
}
```

### 5. æ˜ åƒè¡¨ç¤ºï¼ˆPlayerFragment.ktï¼‰

**SurfaceViewã‚’ä½¿ç”¨ã™ã‚‹ç†ç”±:**
- TextureViewã‚ˆã‚Šä½é…å»¶
- GPUãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒè‰¯ã„
- HDR/DRMå¯¾å¿œ
- ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ´»ç”¨å¯èƒ½

```kotlin
class PlayerFragment : Fragment() {
    private lateinit var surfaceView: SurfaceView
    private lateinit var viewModel: PlayerViewModel
    
    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        return FrameLayout(requireContext()).apply {
            surfaceView = SurfaceView(context).apply {
                layoutParams = FrameLayout.LayoutParams(
                    FrameLayout.LayoutParams.MATCH_PARENT,
                    FrameLayout.LayoutParams.MATCH_PARENT
                )
            }
            addView(surfaceView)
            
            // UIè¦ç´ ï¼ˆéŒ²ç”»ãƒœã‚¿ãƒ³ç­‰ï¼‰ã‚‚ã“ã“ã«è¿½åŠ 
        }
    }
    
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        
        surfaceView.holder.addCallback(object : SurfaceHolder.Callback {
            override fun surfaceCreated(holder: SurfaceHolder) {
                viewModel.setSurface(holder.surface)
            }
            
            override fun surfaceChanged(
                holder: SurfaceHolder,
                format: Int,
                width: Int,
                height: Int
            ) {}
            
            override fun surfaceDestroyed(holder: SurfaceHolder) {
                viewModel.setSurface(null)
            }
        })
        
        // ç”»é¢å¸¸æ™‚ã‚ªãƒ³
        requireActivity().window.addFlags(
            WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON
        )
    }
}
```

---

## UIè¨­è¨ˆ

### ãƒ¡ã‚¤ãƒ³ç”»é¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â‰¡] NDI Receiver                            [âš™ï¸ Settings]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚              NDIã‚½ãƒ¼ã‚¹ä¸€è¦§                      â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ“¹ FoMaKo K20UH (CAMERA1)              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    1920x1080 @ 30fps                    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ“¹ OBS Studio (PC-MAIN)                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    1920x1080 @ 60fps                    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  [ğŸ”„ æ›´æ–°]                          [ğŸ“ éŒ²ç”»ä¸€è¦§]       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç”»é¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚                   [æ˜ åƒè¡¨ç¤ºé ˜åŸŸ]                        â”‚
â”‚                   (ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³)                      â”‚
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [â†æˆ»ã‚‹]  FoMaKo K20UH     â— REC 00:05:23    [â¹ï¸åœæ­¢]   â”‚
â”‚          1080p30 | 28.5 Mbps | H.265                    â”‚
â”‚                                                         â”‚
â”‚          [âºï¸ éŒ²ç”»é–‹å§‹]              [ğŸ“ éŒ²ç”»ä¸€è¦§]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éŒ²ç”»ä¸€è¦§ç”»é¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â†æˆ»ã‚‹] éŒ²ç”»ä¸€è¦§                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¬   â”‚ NDI_20260129_143052.mp4                    â”‚ â”‚
â”‚  â”‚      â”‚ 2026/01/29 14:30 | 00:15:23 | 1.2GB        â”‚ â”‚
â”‚  â”‚      â”‚                              [â–¶ï¸][ğŸ—‘ï¸]      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¬   â”‚ NDI_20260129_120015.mp4                    â”‚ â”‚
â”‚  â”‚      â”‚ 2026/01/29 12:00 | 00:45:12 | 3.8GB        â”‚ â”‚
â”‚  â”‚      â”‚                              [â–¶ï¸][ğŸ—‘ï¸]      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ³¨æ„äº‹é …ãƒ»åˆ¶ç´„

### 1. Devolayã®åˆ¶ç´„
- **x86_64ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã§ã¯å‹•ä½œã—ãªã„**ï¼ˆx86ã¾ãŸã¯ARMã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã€å®Ÿæ©Ÿã‚’ä½¿ç”¨ï¼‰
- åˆå›ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚‹

### 2. RK3576å›ºæœ‰ã®è€ƒæ…®äº‹é …
- MediaCodecã§H.265ãƒ‡ã‚³ãƒ¼ãƒ‰æ™‚ã«ç·‘è‰²ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆãŒå‡ºã‚‹å ´åˆãŒã‚ã‚‹
- ãã®å ´åˆã¯Rockchipã®MPPï¼ˆMedia Process Platformï¼‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨ã‚’æ¤œè¨
- MPPã¯ `/system/lib64/librockchip_mpp.so` ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§

### 3. NDI HX3ã®ç‰¹æ€§
- åœ§ç¸®æ¸ˆã¿ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆH.264/H.265ï¼‰
- Devolayã§å—ä¿¡ã—ãŸç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥MediaMuxerã«æ¸¡ã™ã“ã¨ã§ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼éŒ²ç”»ãŒå¯èƒ½
- ãƒ•ãƒ«NDIï¼ˆéåœ§ç¸®ï¼‰ã¨ã¯ç•°ãªã‚Šã€ãƒ‡ã‚³ãƒ¼ãƒ‰ãŒå¿…é ˆ

### 4. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è€ƒæ…®äº‹é …
- WiFiç’°å¢ƒã§ã¯é…å»¶ã‚„ãƒ‘ã‚±ãƒƒãƒˆãƒ­ã‚¹ã«æ³¨æ„
- å¯èƒ½ã§ã‚ã‚Œã°5GHzå¸¯ã‚’ä½¿ç”¨
- è¤‡æ•°ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãŒåŒæ™‚å—ä¿¡ã™ã‚‹å ´åˆã€NDI Bridgeã§ã®è¤‡è£½ã‚’æ¨å¥¨ï¼ˆåˆ¥é€”PCå¿…è¦ï¼‰

### 5. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¡¨è¨˜
ã‚¢ãƒ—ãƒªå†…ã¾ãŸã¯Aboutç”»é¢ã«ä»¥ä¸‹ã‚’è¨˜è¼‰ï¼š
```
NDIÂ® is a registered trademark of Vizrt NDI AB.
```

---

## é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºæœ¬å—ä¿¡ãƒ»è¡¨ç¤ºï¼ˆ2-3æ—¥ï¼‰
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆGradle, Devolayä¾å­˜é–¢ä¿‚ï¼‰
- [ ] NDIåˆæœŸåŒ–ãƒ»çµ‚äº†å‡¦ç†
- [ ] ã‚½ãƒ¼ã‚¹æ¤œå‡ºãƒ»ä¸€è¦§è¡¨ç¤º
- [ ] åŸºæœ¬çš„ãªæ˜ åƒå—ä¿¡ãƒ»è¡¨ç¤º

### Phase 2: éŒ²ç”»æ©Ÿèƒ½ï¼ˆ2-3æ—¥ï¼‰
- [ ] MediaMuxerã«ã‚ˆã‚‹MP4éŒ²ç”»
- [ ] ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼éŒ²ç”»ã®å®Ÿè£…
- [ ] éŒ²ç”»UIï¼ˆé–‹å§‹/åœæ­¢ãƒœã‚¿ãƒ³ã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼‰

### Phase 3: å†ç”Ÿãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ï¼ˆ1-2æ—¥ï¼‰
- [ ] éŒ²ç”»ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
- [ ] å‹•ç”»å†ç”Ÿæ©Ÿèƒ½
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤æ©Ÿèƒ½

### Phase 4: UI/UXæ”¹å–„ï¼ˆ1-2æ—¥ï¼‰
- [ ] ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³æœ€é©åŒ–
- [ ] OSDè¡¨ç¤º
- [ ] è¨­å®šç”»é¢
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## ãƒ†ã‚¹ãƒˆé …ç›®

### æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [ ] NDIã‚½ãƒ¼ã‚¹ã®æ¤œå‡ºï¼ˆåŒä¸€ã‚µãƒ–ãƒãƒƒãƒˆï¼‰
- [ ] NDIã‚½ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãƒ»åˆ‡æ–­
- [ ] æ˜ åƒã®è¡¨ç¤ºï¼ˆ1080p30ï¼‰
- [ ] éŒ²ç”»ã®é–‹å§‹ãƒ»åœæ­¢
- [ ] éŒ²ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç”Ÿ
- [ ] é•·æ™‚é–“éŒ²ç”»ï¼ˆ1æ™‚é–“ä»¥ä¸Šï¼‰
- [ ] è¤‡æ•°å›ã®æ¥ç¶šãƒ»åˆ‡æ–­ã‚µã‚¤ã‚¯ãƒ«

### æ€§èƒ½ãƒ†ã‚¹ãƒˆ
- [ ] é…å»¶æ¸¬å®šï¼ˆç›®æ¨™: 100msä»¥ä¸‹ï¼‰
- [ ] CPUä½¿ç”¨ç‡ï¼ˆéŒ²ç”»ä¸­å«ã‚€ï¼‰
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- [ ] ç™ºç†±çŠ¶æ³

### äº’æ›æ€§ãƒ†ã‚¹ãƒˆ
- [ ] FPD CP25-J1ã§ã®å‹•ä½œç¢ºèª
- [ ] FoMaKo K20UHã‹ã‚‰ã®å—ä¿¡ç¢ºèª
- [ ] WiFiç’°å¢ƒã§ã®å®‰å®šæ€§

---

## å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- NDI SDK Documentation: https://docs.ndi.video/
- Devolay GitHub: https://github.com/WalkerKnapp/devolay
- Android MediaCodec: https://developer.android.com/reference/android/media/MediaCodec
- Android MediaMuxer: https://developer.android.com/reference/android/media/MediaMuxer

### å‚è€ƒå®Ÿè£…
- NdiMonitor (Android): https://github.com/daubli/NdiMonitor
- NDIPlayer (Android TV): https://github.com/dreamgen/NDIPlayer

### NDI SDKãƒ©ã‚¤ã‚»ãƒ³ã‚¹
- Standard SDK: ãƒ­ã‚¤ãƒ¤ãƒªãƒ†ã‚£ãƒ•ãƒªãƒ¼ã€å•†ç”¨åˆ©ç”¨å¯
- è¦ä»¶: ndi.videoã¸ã®ãƒªãƒ³ã‚¯ + å•†æ¨™è¡¨è¨˜ã®ã¿
